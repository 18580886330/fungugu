jQuery.extend({createUploadIframe:function(e,t){var a="jUploadFrame"+e;if(window.ActiveXObject){(r=document.createElement("iframe")).id=a,r.name=a,"boolean"==typeof t?r.src="javascript:false":"string"==typeof t&&(r.src=t)}else{var r=document.createElement("iframe");r.id=a,r.name=a}return r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",document.body.appendChild(r),r},createUploadForm:function(e,t){var a="jUploadForm"+e,r="jUploadFile"+e,n=$('<form  action="" method="POST" name="'+a+'" id="'+a+'" enctype="multipart/form-data"></form>'),o=$("#"+t),d=o.clone(!0);return $(o).attr("id",r),$(o).before(d),$(o).appendTo(n),$(n).css("position","absolute"),$(n).css("top","-1200px"),$(n).css("left","-1200px"),$(n).appendTo("body"),n},addOtherRequestsToForm:function(e,t){var a=$('<input type="hidden" name="" value="">');for(var r in t){name=r,value=t[r];var n=a.clone();n.attr({name:name,value:value}),$(n).appendTo(e)}return e},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),a=jQuery.createUploadForm(t,e.fileElementId);e.data&&(a=jQuery.addOtherRequestsToForm(a,e.data));jQuery.createUploadIframe(t,e.secureuri);var r="jUploadFrame"+t,n="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var o=!1,d={};e.global&&jQuery.event.trigger("ajaxSend",[d,e]);var u=function(t){var n=document.getElementById(r);try{n.contentWindow?(d.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerHTML:null,d.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document):n.contentDocument&&(d.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerHTML:null,d.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document)}catch(t){jQuery.handleError(e,d,null,t)}if(d||"timeout"==t){o=!0;var u;try{if("error"!=(u="timeout"!=t?"success":"error")){var c=jQuery.uploadHttpData(d,e.dataType);e.success&&e.success(c,u),e.global&&jQuery.event.trigger("ajaxSuccess",[d,e])}else jQuery.handleError(e,d,u)}catch(t){u="error",jQuery.handleError(e,d,u,t)}e.global&&jQuery.event.trigger("ajaxComplete",[d,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(d,u),jQuery(n).unbind(),setTimeout(function(){try{$(n).remove(),$(a).remove()}catch(t){jQuery.handleError(e,d,null,t)}},100),d=null}};e.timeout>0&&setTimeout(function(){o||u("timeout")},e.timeout);try{a=$("#"+n);$(a).attr("action",e.url),$(a).attr("method","POST"),$(a).attr("target",r),a.encoding?a.encoding="multipart/form-data":a.enctype="multipart/form-data",$(a).submit()}catch(t){jQuery.handleError(e,d,null,t)}return window.attachEvent?document.getElementById(r).attachEvent("onload",u):document.getElementById(r).addEventListener("load",u,!1),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;if(data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type){var data=r.responseText,rx=new RegExp("<pre.*?>(.*?)</pre>","i"),am=rx.exec(data),data=am?am[1]:"";if(document.attachEvent||-1!=navigator.userAgent.toLowerCase().indexOf("windows"))return data=-1!=data.indexOf("/")?data.replace(/\\/,""):data;eval("data = data")}return"html"==type&&jQuery("<div>").html(data).evalScripts(),data},handleError:function(e,t,a,r){e.error&&e.error.call(e.context||e,t,a,r),e.global&&(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,r])}});