require(["src/components/city/js/city-7bf7fa2cf2.server.js","src/components/feedBack/js/feedBack-4a52d1e27a.server.js"],function(t,e){({init:function(){this.authorFlag=!1,this.leftModules()},headerModules:function(){return},leftModules:function(){var t=$("#navTree"),e=this,i="",a=t.data().modules.replace(/[\[\]]/g,"").split(",");if(yf.treeModuleData){for(var n=0;n<yf.treeModuleData.length;n++){var s=yf.treeModuleData[n];if(i+='<li class="nav-tree-item">                    <a class="link" href="javascript:;"><b class="icon '+s.info.nameEn+'"></b><span>'+s.info.nameZn+"</span></a>",s.children.length){i+='<ul class="nav-tree-child">';for(var c=0;c<s.children.length;c++){var o=s.children;o[c].cityAuthority==yf.userInfo.city&&("房产估值"==o[c].nameZn?i+='<li class="nav-tree-item">                                    <a class="link" data-href="'+o[n].nameEn+'" href="javascript:;"><b class="icon '+o[n].nameEn+'"></b><span>'+o[n].nameZn+"</span></a>                                </li>":i+='<li class="nav-tree-child">                                    <a class="link" data-href="'+o[c].nameEn+'" href="#/'+o[c].nameEn+'"><b class="icon"></b><span>'+o[c].nameZn+"</span></a>                                </li>")}i+="</ul>",i+="</li>"}}t.prepend(i).find("a[data-href]").each(function(t,i){$(i).unbind().bind("click",function(){e.isHaveNews(a)})}),e.isHaveNews(a),$('a[data-href="propertyValuation"],a[data-href="intelligentSearch"]').click(function(){yf.param("housingName")||(location.href="#/layout")}),yf.runNavActive()}},isHaveNews:function(t){if(!this.authorFlag)for(var e=0;e<t.length;e++)"artificialNuclearValence"==t[e]&&(this.authorFlag=!0,$("#message_box").removeClass("hide"));this.authorFlag&&$.ajax({type:"get",url:"/api/v1/artificialNuclearValence/"+yf.userInfo.city+"/newMsgStateGet",success:function(t){var e=null;"200"==t.code?($("#red_dot").removeClass("hide"),e=setInterval(function(){$("#red_dot").fadeIn(500).fadeOut(500)},1e3)):($("#red_dot").addClass("hide"),null!=e&&clearInterval(e))}})}}).init(),{data:{purchasedProvince:null,notBurchasedProvince:null,purchasedLetter:null,notPurchasedLetter:null,buyAllData:[],notBuyAllData:[],allData:[]},init:function(){return this.cityContent=$("#cityContent"),this.cityBody=$("#cityLink"),this.cityName=this.cityBody.find(".name").eq(0),this.changeCityBtn=this.cityBody.find(".change-city").eq(0),this.loadModules(),this},updateCityInfo:function(t){this.popCityName.text(t),yf.updataCity(t),layer.closeAll(),"houseValuation"==yf.matchRouter()&&(location.href="#/layout"),location.reload()},loadModules:function(){var t=this;this.changeCityBtn.unbind("click").bind("click",function(){yf.path.load("#cityContent",{controllerUrl:"src/components/city/js/city-d41d8cd98f.controller.js",templateUrl:"src/components/city/city.html",reload:!1}),layer.open({area:["560px",""],type:1,closeBtn:!1,title:!1,shade:[.6,"#000"],resize:!1,content:t.cityContent,success:function(){t.popCityName=$("#popCityName"),t.cityLogs=t.cityContent.find(".search-logs").eq(0),t.province=t.cityContent.find('div[data-sort="province"]'),t.letter=t.cityContent.find('div[data-sort="letter"]'),t.cityListContent=t.cityContent.find(".citylist-content").eq(0),t.aCityList=t.cityListContent.find(".city-list"),t.popCityName.text(yf.userInfo.city),t.searchCity(),t.bindEvent()},end:function(){$("#cityContent").hide()}}),yf.scroll({elmId:"#cityScrollContent"})})},searchCity:function(){var e=this;t.getCity().success(function(t){var t=t.data;!function(){for(var i="<span>常用城市：</span>",a=0;a<t.inCommonUseCity.length;a++)i+='<a href="javascript:;" class="item">'+t.inCommonUseCity[a].cityName+"</a>";e.cityLogs.removeClass("hide").html(i),e.aLinkCityEvent(e.cityLogs.find(".item"))}(),e.saveData(t),e.buyCityListProvince(t.authorityProvinceCity.purchased)}).error(function(t){})},saveData:function(t){var e=this;if(!this.data.purchasedLetter||!this.data.purchasedLetter.length){this.data.purchasedProvince=t.authorityProvinceCity.purchased,this.data.notBurchasedProvince=t.authorityProvinceCity.notPurchased,this.data.purchasedLetter=t.authorityInitialCity.purchased.cityData,this.data.notPurchasedLetter=t.authorityInitialCity.notPurchased.cityData,this.data.allCityData=this.data.purchasedLetter.concat(this.data.notPurchasedLetter);for(i=0;i<this.data.purchasedLetter.length;i++)if((a=this.data.purchasedLetter[i]).citys.length>0)for(n=0;n<a.citys.length;n++)this.data.buyAllData.push({cityName:a.citys[n].cityName,cityNameEn:a.citys[n].cityNameEn,spellingAlphabet:a.citys[n].spellingAlphabet});for(var i=0;i<this.data.allCityData.length;i++){var a=this.data.allCityData[i];if(a.citys.length>0)for(var n=0;n<a.citys.length;n++)this.data.allData.push({cityName:a.citys[n].cityName,cityNameEn:a.citys[n].cityNameEn,spellingAlphabet:a.citys[n].spellingAlphabet})}var s="",c="";$("#searchCityInput").autoprompting({style:{"max-height":"175px"},time:100,getType:"static",otherElm:"#searchCity",staticData:e.data.allData,render:function(t){for(var i=0;i<e.data.buyAllData.length;i++){s="";{if(e.data.buyAllData[i].cityName==t.cityName){s="",c="";break}s="没有权限",c="disabled"}}return'<li class="'+c+'" data-isbuy="'+s+'" data-keywords="'+t.cityName+'">'+t.cityName+"<span>"+s+"</span></li>"},enter:function(t,i){for(var a=!1,n=0;n<e.data.buyAllData.length;n++){if(e.data.buyAllData[n].cityName.match(t.keywords)&&e.data.buyAllData[n].cityName.match(t.keywords)[0]){a=!0;break}a=!1}a&&($("#searchCityInput").val(t.keywords),e.updateCityInfo(t.keywords))}})}},buyCityListProvince:function(t){var e=this.cityContent.find('div[data-sort="buyProvince"]');this.createProvinceDom(e,t,"buy")},notBuyCityListProvince:function(t){var e=this.cityContent.find('div[data-sort="notBuyProvince"]');this.createProvinceDom(e,t,"notBuy")},buyCityListLetter:function(t){var e=this.cityContent.find('div[data-sort="buyLetter"]');this.createLetterDom(e,t,"buy")},notBuyCityListLetter:function(t){var e=this.cityContent.find('div[data-sort="notBuyLetter"]');this.createLetterDom(e,t,"notBuy")},showHide:function(t){this.aCityList.addClass("hide").removeClass("show"),t.removeClass("hide")},createProvinceDom:function(t,e,i){if(this.showHide(t),"true"!=t[0].getAttribute("data-loading")){var a=e.municipalityData,n=e.provinceData,s="";if(a.length){s+='<li>                <div class="key">直辖市：</div>                <div class="vals">';for(c=0;c<a.length;c++)s+='<a href="javascript:;" data-type="'+i+'" class="link '+i+'">'+a[c].cityName+"</a>";s+="</div>                </li>"}for(var c=0;c<n.length;c++)if((e=n[c]).citys.length){s+='<li>                    <div class="key">'+e.province+'：</div>                    <div class="vals">';for(var o=0;o<e.citys.length;o++)s+='<a href="javascript:;" data-type="'+i+'" class="link '+i+'">'+e.citys[o].cityName+"</a>";s+="</div>                    </li>"}t.attr("data-loading","true").addClass("show").removeClass("hide").find("ul").html(s),this.aLinkCityEvent($('div[data-sort="buyProvince"]').find('a[data-type="buy"]'))}},createLetterDom:function(t,e,i){if(this.showHide(t),"true"!=t[0].getAttribute("data-loading")){for(var a="",n=0;n<e.length;n++){var s=e[n];if(s.citys.length){a+='<li>                    <div class="key">'+s.initial.toUpperCase()+'：</div>                    <div class="vals">';for(var c=0;c<s.citys.length;c++)a+='<a href="javascript:;" data-type="'+i+'" class="link '+i+'">'+s.citys[c].cityName+"</a>";a+="</div>                    </li>"}}t.attr("data-loading","true").addClass("show").removeClass("hide").find("ul").html(a),this.aLinkCityEvent($('div[data-sort="buyLetter"]').find('a[data-type="buy"]'))}},aLinkCityEvent:function(t){var e=this;t.each(function(t,i){$(i).unbind("click").bind("click",function(){e.updateCityInfo($(this).text())})})},bindEvent:function(){var t=this;this.modelTab=this.cityContent.find(".model-tab").eq(0),this.modelTabLi=this.modelTab.find("li"),this.buyType=this.cityContent.find(".buy-type").eq(0),this.oAs=this.buyType.find("a"),this.modelTabLi.eq(0).addClass("active").siblings().removeClass("active"),this.oAs.eq(0).addClass("active").siblings().removeClass("active"),$("#searchCityInput").val(""),this.modelTabLi.each(function(e,i){$(i).unbind("click").bind("click",function(){$(this).addClass("active").siblings().removeClass("active"),t.changePanel($(this).data().name)})}),this.oAs.each(function(e,i){$(i).unbind("click").bind("click",function(){$(this).addClass("active").siblings().removeClass("active"),t.changePanel($(this).data().name)})})},changePanel:function(t){if("buy"==t)"province"==(e=this.modelTab.find("li.active[data-name]").data().name)?this.buyCityListProvince(this.data.purchasedProvince):"letter"==e&&this.buyCityListLetter(this.data.purchasedLetter);else if("notBuy"==t){var e=this.modelTab.find("li.active[data-name]").data().name;"province"==e?this.notBuyCityListProvince(this.data.notBurchasedProvince):"letter"==e&&this.notBuyCityListLetter(this.data.notPurchasedLetter)}else if("province"==t)"buy"==(i=this.buyType.find("a.active[data-name]").data().name)?this.buyCityListProvince(this.data.purchasedProvince):"notBuy"==i&&this.notBuyCityListProvince(this.data.notBurchasedProvince);else if("letter"==t){var i=this.buyType.find("a.active[data-name]").data().name;"buy"==i?this.buyCityListLetter(this.data.purchasedLetter):"notBuy"==i&&this.notBuyCityListLetter(this.data.notPurchasedLetter)}}}.init(),{init:function(){this.loadModules()},loadModules:function(){var t=this;$("#feedBack").unbind("click").bind("click",function(){yf.path.load("#feedBackContent",{controllerUrl:"src/components/feedBack/js/feedBack-d41d8cd98f.controller.js",templateUrl:"src/components/feedBack/feedBack.html",reload:!1});layer.open({area:["auto","auto"],type:1,closeBtn:!1,title:!1,content:$("#feedBackPop"),resize:!1,success:function(){t.judgeViewFn(),$("#subFeed").unbind("click").bind("click",function(){t.subFeedFn()}),$("#interfaceProposal,#caseFunProposal,#communityGradeProposal,#othersProposal").val(""),$("#interfaceSatisfaction,#caseFunSatisfaction,#communityGradeSatisfaction").attr("checked","checked"),$("#interfaceSatisfaction,#caseFunSatisfaction,#communityGradeSatisfaction").parent().siblings("label").find("input").removeAttr("checked"),yf.limitStr("#interfaceProposal","#inter_num","300"),yf.limitStr("#othersProposal","#feed_num","300")},end:function(){$("#feedBackPop").hide()}})})},subFeedFn:function(){var t="",i={interfaceSatisfaction:t=$("#interfaceSatisfaction").is(":checked")?1:0,interfaceProposal:yf.replaceHtml($("#interfaceProposal").val()),othersProposal:yf.replaceHtml($("#othersProposal").val())};e.sendFeed(i).success(function(t){201==t.code?(layer.closeAll(),layer.msg("提交成功，感谢您的建议 ,您的支持是我们房估估前进的动力~",{time:3e4,btn:["知道了"]})):(layer.closeAll(),layer.msg("提交失败，请重新尝试",{time:2e4,btn:["知道了"]}))}).error(function(){})},judgeViewFn:function(){$(".feed-back-hd").find("input").unbind("change").bind("change",function(t){t.stopPropagation(),$(this).is(":checked")?($(this).attr("checked","checked"),$(this).parent().siblings("label").find("input").removeAttr("checked")):($(this).removeAttr("checked"),$(this).parent().siblings("label").find("input").attr("checked","checked"))})}}.init(),{init:function(){this.fixCon=$("#fix_tool"),this.autoHeight()},autoHeight:function(){function t(){i=$(window).height(),a=e.fixCon.height(),e.fixCon.css("top",parseInt((i-a)/2)+"px").animate({right:"0px"},300)}var e=this,i=0,a=0;t(),$(window).resize(t)}}.init()});