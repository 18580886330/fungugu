require(["src/components/artificialNuclearValence/js/artificialNuclearValence-c5d861c9de.server.js"],function(i){({init:function(){var i=this;this.hrefUrl=window.location.href,this.showPopFn(),yf.loadFile("src/content/js/third/webUpload/diyUpload-3b10c58645.js",function(){i.upPicInitFn()}),this.upPicNum=0,this.hosuePicArr=[],this.villPicArr=[],this.otherPicArr=[],this.doSubAllFn(),yf.scroll({elmId:"#manmade_scroll"})},showPopFn:function(){-1!=this.hrefUrl.indexOf("houseValuation")&&($("#md_name").val(yf.$params().housingName+yf.$params().buildingName+yf.$params().unitName+yf.$params().houseName),$("#md_area").val(yf.$params().houseArea),$("#md_house_type,#md_house_toward").hide(),$("#md_Fhouse_type").val(yf.filterStr(yf.$params().estateType)),$("#md_Fhouse_toward").val(yf.filterStr(yf.$params().toward)),$("#md_year").val(yf.filterStr(yf.$params().year)),$("#md_floor").val(yf.filterStr(yf.$params().floor)),$("#md_totalFloor").val(yf.filterStr(yf.$params().sumFloor)),$("#md_special").val(yf.filterStr(yf.$params().special)),$("#md_baseInfo input,#md_baseInfo select").attr("disabled","disabled"),$("#md_confirm_price").removeAttr("disabled")),-1!=this.hrefUrl.indexOf("pricingLogs")&&($("#md_Fhouse_type,#md_Fhouse_toward").hide(),layui.use(["form"],function(){layui.form.render("select")})),this.reckonPricFn(),layer.open({area:["auto","auto"],type:1,closeBtn:!1,title:!1,shade:[.6,"#000"],resize:!1,content:$("#artifical_info_pop"),end:function(){$("#artificialNuclearValence").html("")}})},upPicInitFn:function(){this.uploadPic("#premises","房本图片"),this.uploadPic("#village_pics","小区图片"),this.uploadPic("#others_pics","其他图片")},uploadPic:function(i,e){var r=this;$(i).diyUpload({url:"/api/v1/imageUpload",success:function(i){switch(r.upPicNum--,e){case"房本图片":r.hosuePicArr.push(i.data);break;case"小区图片":r.villPicArr.push(i.data);break;case"其他图片":r.otherPicArr.push(i.data)}0==r.upPicNum&&r.sendInfoFn()},error:function(i){yf.removeLoading("#manmade_scroll")},formData:{imgType:e},buttonText:"选择图片",chunked:!1,chunkSize:524288,fileNumLimit:2,fileSizeLimit:209715200,fileSingleSizeLimit:8388608})},doSubAllFn:function(){var i=this;$("#sendMI").off("click").click(function(){if(i.checkRuleFn()){yf.loading("#manmade_scroll");for(var e=$(".parentFileBox").find(".fileBoxUl li"),r=e.length,t=0;t<r;t++)void 0!=e.eq(t).attr("data-reup")&&(i.upPicNum++,yf.loading("#manmade_scroll"),$(".diyStart").trigger("click"));0==i.upPicNum&&i.sendInfoFn()}})},sendInfoFn:function(){var e={city:yf.userInfo.city,area:this.disposeStrFn(yf.replaceHtml($("#md_area").val())),comName:this.disposeStrFn(yf.replaceHtml($("#md_name").val())),priceType:"0",houseType:this.disposeStrFn(yf.replaceHtml($("#md_house_type").val())),floor:this.disposeStrFn(yf.replaceHtml($("#md_floor").val())),totalFloor:this.disposeStrFn(yf.replaceHtml($("#md_totalFloor").val())),toward:this.disposeStrFn(yf.replaceHtml($("#md_house_toward").val())),specialFactors:this.disposeStrFn(yf.replaceHtml($("#md_special").val())),buildYear:this.disposeStrFn(yf.replaceHtml($("#md_year").val())),price:"",totalPrice:"",confirmPrice:this.disposeStrFn(yf.replaceHtml($("#md_confirm_price").val())),confirmTotalPrice:this.disposeStrFn(yf.replaceHtml($("#md_confirm_Tprice").val())),priceDY:"",priceZY:"",premisesPermitImgOne:void 0==this.hosuePicArr[0]?"":this.hosuePicArr[0],premisesPermitImgTwo:void 0==this.hosuePicArr[1]?"":this.hosuePicArr[1],comImgOne:void 0==this.villPicArr[0]?"":this.villPicArr[0],comImgTwo:void 0==this.villPicArr[1]?"":this.villPicArr[1],otherImgOne:void 0==this.otherPicArr[0]?"":this.otherPicArr[0],otherImgTwo:void 0==this.otherPicArr[1]?"":this.otherPicArr[1]};-1!=this.hrefUrl.indexOf("houseValuation")&&(e.price=yf.$params().jUnitPrice,e.totalPrice=yf.$params().jTotalPrice),i.sendPriceFn(e).success(function(i){"200"==i.code?($("#go_chat").attr("href","./chatServer.html?bussinessID="+i.data.bussinessId+"&recordID="+i.data.recordId),layer.open({type:"1",title:!1,closeBtn:!1,shadeClose:!1,resize:!1,area:["auto","auto"],content:$("#toChat"),success:function(i,e){$("#go_chat").off("click").click(function(){yf.removeLoading("#manmade_scroll"),layer.close(e)}),$("#go_chat").off("click").click(function(){yf.removeLoading("#manmade_scroll"),layer.closeAll()})},end:function(){$("#toChat").hide(),yf.removeLoading("#manmade_scroll")}})):layer.msg(i.msg,{time:3e3},function(){yf.removeLoading("#manmade_scroll"),layer.closeAll()})}).error(function(i){yf.removeLoading("#manmade_scroll")})},checkRuleFn:function(){var i=!0,e=this;this.getFieldsFn();var r=this.mdName.val(),t=this.mdArea.val(),a=this.mdYear.val();if(mdSzlcVal=this.mdSzlc.val(),mdZlcVal=this.mdZlc.val(),mdFkdjVal=this.mdFkdj.val(),sYear=(new Date).getFullYear(),-1!=this.hrefUrl.indexOf("pricingLogs")){if(""==r)return this.misTipsFn("请输入核价对象",e.mdName),void(i=!1);if(/[~#^$@%&！!*]/.test(r))return this.misTipsFn("核价对象不能有特殊字符",e.mdName),void(i=!1);if(""==t)return this.misTipsFn("请输入具体的建筑面积",e.mdArea),void(i=!1);if(!/^[1-9]\d{0,3}(\.\d{0,2})?$/.test(t)||t>9998.99)return this.misTipsFn("请输入面积为1~9998.99，只留两位小数",e.mdArea),void(i=!1);if(""!=a&&!/^\d{4}$/.test(a))return this.misTipsFn("请输入年代为1900~"+sYear+"的四位整数！",e.mdYear),void(i=!1);if(""!=a&&(a<1900||a>sYear))return e.oYear.focus(),this.misTipsFn("请输入年代为1900~"+sYear+"的四位整数！",e.mdYear),void(i=!1);if(""!=mdSzlcVal&&!/^\d{1,2}$|-1$/.test(mdSzlcVal))return this.misTipsFn("所在楼层应该为-1或1~99！",e.mdSzlc),void(i=!1);if(""!=mdSzlcVal&&"0"==mdSzlcVal)return this.misTipsFn("所在楼层应该为-1或1~99！",e.mdSzlc),void(i=!1);if(""!=mdZlcVal&&!/^\d{0,2}$/.test(mdZlcVal))return this.misTipsFn("总楼层应该为1~99！",e.mdZlc),void(i=!1);if(""!=mdZlcVal&&"0"==mdZlcVal)return e.oSumFloor.focus(),this.misTipsFn("总楼层应该为1~99！",e.mdZlc),void(i=!1);if(""!=mdSzlcVal&&""!=mdZlcVal&&Number(mdSzlcVal)>Number(mdZlcVal))return this.misTipsFn("所在楼层不能大于总楼层！",e.mdSzlc),void(i=!1)}return(isNaN(mdFkdjVal)||0>=mdFkdjVal)&&""!=mdFkdjVal?(this.misTipsFn("请输入正确的单价！",e.mdFkdj),void(i=!1)):i},reckonPricFn:function(){$("#md_confirm_price").on("keyup",function(){var i=$(this).val();if((isNaN(i)||0>=i)&&""!=i)return layer.tips("请输入正确的单价！","#md_confirm_price",{tips:[2,"#666"]});$("#md_confirm_Tprice").val(Math.round(i*$("#md_area").val()/1e4))})},misTipsFn:function(i,e){$("#manmade_scroll").mCustomScrollbar("scrollTo","top"),setTimeout(function(){layer.tips(i,e,{tips:[1,"#666"]})},300)},getFieldsFn:function(){this.mdName=$("#md_name"),this.mdArea=$("#md_area"),this.mdYear=$("#md_year"),this.mdSzlc=$("#md_floor"),this.mdZlc=$("#md_totalFloor"),this.mdFkdj=$("#md_confirm_price")},disposeStrFn:function(i){return"--"!=i&&"请选择"!=i||(i=""),i}}).init()});