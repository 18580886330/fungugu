require(["src/components/artificialNuclearValence/js/artificialNuclearValence-11b460f60b.server.js"],function(i){({init:function(){var i=this;this.hrefUrl=window.location.href,this.showPopFn(),yf.loadFile("src/content/js/third/webUpload/diyUpload-6810cee38a.js",function(){i.upPicInitFn()}),this.upPicNum=0,this.hosuePicArr=[],this.villPicArr=[],this.otherPicArr=[],this.doSubAllFn(),$("#manmade_scroll").mCustomScrollbar({scrollInertia:180,theme:"minimal-dark",axis:"y",callbacks:{whileScrolling:function(){layer.closeAll("tips")}}})},showPopFn:function(){-1!=this.hrefUrl.indexOf("houseValuation")&&$("#search_pop_affirm").is(":hidden")?($("#md_name").val($("#valuationInput").val()),$("#md_area").val(yf.$params().houseArea),$("#md_house_type,#md_house_toward").hide(),$("#md_Fhouse_type").val(yf.filterStr(yf.$params().estateType)),$("#md_Fhouse_toward").val(yf.filterStr(yf.$params().toward)),$("#md_year").val(yf.filterStr(yf.$params().year)),$("#md_floor").val(yf.filterStr(yf.$params().floor)),$("#md_totalFloor").val(yf.filterStr(yf.$params().sumFloor)),$("#md_special").val(yf.filterStr(yf.$params().special)),$("#md_baseInfo input,#md_baseInfo select").attr("disabled","disabled"),$("#md_confirm_price").removeAttr("disabled")):($("#md_Fhouse_type,#md_Fhouse_toward").hide(),$("#md_name").val($("#search_pop_initem").text()),layui.use(["form"],function(){layui.form.render("select");var i=$("#md_Fhouse_toward").siblings(".layui-unselect").find(".layui-anim");yf.scroll({elmId:i,height:"auto"})})),-1!=this.hrefUrl.indexOf("auditPriceRecord")&&($("#md_Fhouse_type,#md_Fhouse_toward").hide(),layui.use(["form"],function(){layui.form.render("select");var i=$("#md_Fhouse_toward").siblings(".layui-unselect").find(".layui-anim");yf.scroll({elmId:i,height:"auto"})})),-1!=this.hrefUrl.indexOf("layout")&&($("#md_Fhouse_type,#md_Fhouse_toward").hide(),$("#md_name").val($("#search_pop_initem").text()),layui.use(["form"],function(){layui.form.render("select");var i=$("#md_Fhouse_toward").siblings(".layui-unselect").find(".layui-anim");yf.scroll({elmId:i,height:"auto"})})),this.reckonPricFn(),this.areaCalFn(),layer.open({area:["auto","auto"],type:1,closeBtn:!1,title:!1,shade:[.6,"#000"],resize:!1,content:$("#artifical_info_pop"),success:function(){$("#search_pop_artificial").blur(),$("#artifical_info_close").off("click").click(function(){layer.closeAll("tips")})},end:function(){$("#auditPriceRecord").html("")}})},upPicInitFn:function(){this.uploadPic("#premises","房本图片"),this.uploadPic("#village_pics","小区图片"),this.uploadPic("#others_pics","其他图片")},uploadPic:function(i,e){var r=this;$(i).diyUpload({url:"/api/v1/imageUpload",success:function(i){switch(r.upPicNum--,e){case"房本图片":r.hosuePicArr.push(i.data);break;case"小区图片":r.villPicArr.push(i.data);break;case"其他图片":r.otherPicArr.push(i.data)}0==r.upPicNum&&r.sendInfoFn()},error:function(i){yf.removeLoading("#manmade_scroll")},formData:{imgType:e},buttonText:"选择图片",chunked:!1,chunkSize:524288,fileNumLimit:2,fileSizeLimit:209715200,fileSingleSizeLimit:8388608})},doSubAllFn:function(){var i=this;$("#sendMI").off("click").click(function(){if(i.checkRuleFn()){yf.loading("#manmade_scroll");for(var e=$(".parentFileBox").find(".fileBoxUl li"),r=e.length,a=0;a<r;a++)void 0!=e.eq(a).attr("data-reup")&&(i.upPicNum++,yf.loading("#manmade_scroll"),$(".diyStart").trigger("click"));0==i.upPicNum&&i.sendInfoFn()}})},sendInfoFn:function(){var e={curCity:yf.userInfo.city,area:this.disposeStrFn(yf.replaceHtml($("#md_area").val())),comName:this.disposeStrFn(yf.replaceHtml($("#md_name").val())),priceType:"0",houseType:this.disposeStrFn(yf.replaceHtml($("#md_house_type").val())),floor:this.disposeStrFn(yf.replaceHtml($("#md_floor").val())),totalFloor:this.disposeStrFn(yf.replaceHtml($("#md_totalFloor").val())),toward:this.disposeStrFn(yf.replaceHtml($("#md_house_toward").val())),specialFactors:this.disposeStrFn(yf.replaceHtml($("#md_special").val())),buildYear:this.disposeStrFn(yf.replaceHtml($("#md_year").val())),price:"",totalPrice:"",confirmPrice:this.disposeStrFn(yf.replaceHtml($("#md_confirm_price").val())),confirmTotalPrice:this.disposeStrFn(yf.replaceHtml($("#md_confirm_Tprice").val())),priceDY:"",priceZY:"",premisesPermitImgOne:void 0==this.hosuePicArr[0]?"":this.hosuePicArr[0],premisesPermitImgTwo:void 0==this.hosuePicArr[1]?"":this.hosuePicArr[1],comImgOne:void 0==this.villPicArr[0]?"":this.villPicArr[0],comImgTwo:void 0==this.villPicArr[1]?"":this.villPicArr[1],otherImgOne:void 0==this.otherPicArr[0]?"":this.otherPicArr[0],otherImgTwo:void 0==this.otherPicArr[1]?"":this.otherPicArr[1]};-1!=this.hrefUrl.indexOf("houseValuation")&&(e.price=yf.$params().jUnitPrice,e.totalPrice=yf.$params().jTotalPrice,e.toward=this.disposeStrFn($("#md_Fhouse_toward").val()),e.houseType=this.disposeStrFn($("#md_Fhouse_type").val())),i.sendPriceFn(e).success(function(i){i.success?($("#go_chat").attr("href","./chatServer.html?bussinessID="+i.data.bussinessId+"&recordID="+i.data.recordId),layer.open({type:"1",title:!1,closeBtn:!1,shadeClose:!1,resize:!1,area:["auto","auto"],content:$("#toChat"),success:function(i,e){$("#go_chat").off("click").click(function(){yf.removeLoading("#manmade_scroll"),layer.closeAll(),$(".layui-layer-shade").remove()}),$("#artifical_info_close,#chat_close").off("click").click(function(){layer.closeAll(),$(".layui-layer-shade").remove()})},end:function(){$("#toChat").hide(),yf.removeLoading("#manmade_scroll"),$("#artifical_info_close").off("click")}})):layer.msg(i.msg,{time:3e3},function(){yf.removeLoading("#manmade_scroll"),layer.closeAll()})}).error(function(i){yf.removeLoading("#manmade_scroll")})},checkRuleFn:function(){var i=!0;this.getFieldsFn();var e=this.mdName.val(),r=this.mdArea.val(),a=this.mdYear.val();if(mdSzlcVal=this.mdSzlc.val(),mdZlcVal=this.mdZlc.val(),mdFkdjVal=this.mdFkdj.val(),sYear=(new Date).getFullYear(),-1!=this.hrefUrl.indexOf("auditPriceRecord")||-1!=this.hrefUrl.indexOf("layout")||-1!=this.hrefUrl.indexOf("houseValuation")&&!$("#search_pop_affirm").is(":hidden")){if(""==e)return this.misTipsFn("请输入核价对象",this.mdName),void(i=!1);if(/[~#^$@%&！!*]/.test(e))return this.misTipsFn("核价对象不能有特殊字符",this.mdName),void(i=!1);if(!this.limitAreaFn(r,this.mdArea))return;if(""!=a&&!/^\d{4}$/.test(a))return this.misTipsFn("请输入年代为1900~"+sYear+"的四位整数！",this.mdYear),void(i=!1);if(""!=a&&(a<1900||a>sYear))return this.misTipsFn("请输入年代为1900~"+sYear+"的四位整数！",this.mdYear),void(i=!1);if(""!=mdSzlcVal&&!/^\d{1,2}$|-1$/.test(mdSzlcVal))return this.misTipsFn("所在楼层应该为-1或1~99！",this.mdSzlc),void(i=!1);if(""!=mdSzlcVal&&"0"==mdSzlcVal)return this.misTipsFn("所在楼层应该为-1或1~99！",this.mdSzlc),void(i=!1);if(""!=mdZlcVal&&!/^\d{0,2}$/.test(mdZlcVal))return this.misTipsFn("总楼层应该为1~99！",this.mdZlc),void(i=!1);if(""!=mdZlcVal&&"0"==mdZlcVal)return this.misTipsFn("总楼层应该为1~99！",this.mdZlc),void(i=!1);if(""!=mdSzlcVal&&""!=mdZlcVal&&Number(mdSzlcVal)>Number(mdZlcVal))return this.misTipsFn("所在楼层不能大于总楼层！",this.mdSzlc),void(i=!1)}return(isNaN(mdFkdjVal)||0>=mdFkdjVal)&&""!=mdFkdjVal?(this.misTipsFn("请输入正确的单价！",this.mdFkdj),void(i=!1)):i},reckonPricFn:function(){var i=this;$("#md_confirm_price").on("keyup",function(){if(""!=$("#md_area").val()&&i.limitAreaFn($("#md_area").val(),"#md_area")){var e=$(this).val();if(""==e)return void $("#md_confirm_Tprice").val("");if((isNaN(e)||0>=e)&&""!=e)return layer.tips("请输入正确的单价！","#md_confirm_price",{tips:[2,"#666"]});$("#md_confirm_Tprice").val(Math.round(e*$("#md_area").val()/1e4))}})},misTipsFn:function(i,e){$("#manmade_scroll").mCustomScrollbar("scrollTo","top"),setTimeout(function(){layer.tips(i,e,{tips:[1,"#666"]})},300)},getFieldsFn:function(){this.mdName=$("#md_name"),this.mdArea=$("#md_area"),this.mdYear=$("#md_year"),this.mdSzlc=$("#md_floor"),this.mdZlc=$("#md_totalFloor"),this.mdFkdj=$("#md_confirm_price")},disposeStrFn:function(i){return"--"!=i&&"请选择"!=i||(i=""),i},limitAreaFn:function(i,e){var r=!0;return""==i?(this.misTipsFn("请输入具体的建筑面积",e),void(r=!1)):!/^[1-9]\d{0,3}(\.\d{0,2})?$/.test(i)||i>9998.99?(this.misTipsFn("请输入面积为1~9998.99，只留两位小数",e),void(r=!1)):r},areaCalFn:function(){var i=this;$("#md_area").keyup(function(){if(i.limitAreaFn($("#md_area").val(),"#md_area")){var e=$("#md_confirm_price").val();if(""==e)return void $("#md_confirm_Tprice").val("");if((isNaN(e)||0>=e)&&""!=e)return layer.tips("请输入正确的单价！","#md_confirm_price",{tips:[2,"#666"]});$("#md_confirm_Tprice").val(Math.round(e*$("#md_area").val()/1e4))}})}}).init()});